{"version":3,"sources":["../../../react-components/HATextFieldTypeAhead.jsx"],"names":[],"mappings":"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","file":"HATextFieldTypeAhead.js","sourcesContent":["import React, {Component} from 'react';\nimport 'hui/textfield-type-ahead';\n\nfunction toStore(data) {\n    return {\n        query() {\n            return {\n                then(callback) {\n                    callback(data);\n                }\n            };\n        }\n    };\n}\n\nfunction propsWithout(exludeList, props) {\n    return Object.getOwnPropertyNames(props).reduce((newProps, propName) => {\n        if (exludeList.indexOf(propName) < 0) {\n            newProps[propName] = props[propName];\n        }\n        return newProps;\n    }, {});\n}\n\nfunction pluckSelectedItem(event) {\n    var selectedItem = event.target.selectedItem;\n    // for backward-compatibility\n    event.selectedItem = selectedItem;\n\n    return event;\n}\n\nexport default class HATextFieldTypeAhead extends Component {\n    static propTypes = {\n        className: React.PropTypes.string,\n        label: React.PropTypes.string,\n        placeholder: React.PropTypes.string,\n        icon: React.PropTypes.string,\n        name: React.PropTypes.string,\n        value: React.PropTypes.string,\n        typedText: React.PropTypes.string,\n        size: React.PropTypes.number,\n        disabled: React.PropTypes.bool,\n        required: React.PropTypes.bool,\n        noRequiredIndicator: React.PropTypes.bool,\n        selectedIndex: React.PropTypes.number,\n        selectedItem: React.PropTypes.object,\n        filterMode: React.PropTypes.string,\n        store: React.PropTypes.object,\n        storeLabelProperty: React.PropTypes.string,\n        storeValueProperty: React.PropTypes.string,\n        staticItems: React.PropTypes.bool,\n        addNew: React.PropTypes.oneOfType([React.PropTypes.bool, React.PropTypes.string]),\n        addNewText: React.PropTypes.string,\n        min: React.PropTypes.number,\n        max: React.PropTypes.number,\n        requiredMessage: React.PropTypes.string,\n        invalidMessage: React.PropTypes.string,\n        validator: React.PropTypes.func,\n        onValidityChange: React.PropTypes.func,\n        alwaysRenderValidity: React.PropTypes.bool,\n        autoComplete: React.PropTypes.string,\n\n        onClick: React.PropTypes.func,\n        onChange: React.PropTypes.func,\n        data: React.PropTypes.array,\n        children: React.PropTypes.element\n    };\n\n    constructor(props) {\n        super(props);\n        this._huiComponent = null;\n\n        // Bind event handling methods to current instance\n        this.handleClick = this.handleClick.bind(this);\n        this.handleRef = this.handleRef.bind(this);\n    }\n\n    componentDidMount() {\n        // Event handler for change\n        this._huiComponent.addEventListener('change', (event) => {\n            event.stopPropagation();\n            if (this.props.onChange) {\n                this.props.onChange(pluckSelectedItem(event));\n            }\n            this.testValidity();\n        });\n\n        this.domElementPostRender();\n\n        window.setTimeout(() => {\n            // We need the timeout so h-ui component checkValidity function is initialized\n            if (this.props.validator) {\n                this._huiComponent.validator = this.props.validator;\n            }\n            if (this.props.alwaysRenderValidity) {\n                this._huiComponent.reportValidity();\n            }\n            this.testValidity(); // We need to do initial notification of validity state.\n        }, 0);\n    }\n\n    componentDidUpdate() {\n        if (this.props.validator) {\n            this._huiComponent.validator = this.props.validator;\n        }\n        if (this.props.alwaysRenderValidity) {\n            this._huiComponent.reportValidity();\n        }\n\n        this.domElementPostRender();\n    }\n\n    componentWillUnmount() {\n        this._huiComponent.removeEventListener('change', null, false);\n    }\n\n    testValidity() {\n        if (this.props.onValidityChange) {\n            let valid;\n            if (this._huiComponent.checkValidity) {\n                valid = this._huiComponent.checkValidity();\n            }\n            if (this._lastValidity !== valid) {\n                this._lastValidity = valid;\n                this.props.onValidityChange(valid);\n            }\n        }\n    }\n\n    //Event handler for Click\n    handleClick(event) {\n        if (this.props.onClick) {\n            this.props.onClick(event);\n        }\n    }\n\n    handleRef(c) {\n        this._huiComponent = c;\n    }\n\n    // Get a reference to our internal store/collection\n    getStore() {\n        const {store, data} = this.props,\n            huiComponent = this._huiComponent;\n\n        if (store) {\n            return store;\n        } else if (data) {\n            if (this._currentData === data) {\n                // If data has not changed return the current store\n                return huiComponent.store;\n            } else {\n                this._currentData = data;\n                return toStore(data);\n            }\n        } else {\n            return toStore([]);\n        }\n    }\n\n    domElementPostRender() {\n        const {value, selectedIndex} = this.props,\n            huiComponent = this._huiComponent,\n            newStore = this.getStore();\n\n        // Don't set the store if it is the same as the current store\n        if (newStore !== huiComponent.store) {\n            huiComponent.store = newStore;\n        }\n\n        if (value && value !== huiComponent.value) {\n            // After the store is set, we need to set the value again\n            huiComponent.value = this.props.value;\n            // And then we remove 'menu-expanded' to make sure the popover remains closed.\n            huiComponent.classList.remove('menu-expanded');\n        }\n\n        if (selectedIndex && selectedIndex !== huiComponent.selectedIndex) {\n            // After the store is set, we need to set the selectedIndex again\n            huiComponent.selectedIndex = this.props.selectedIndex;\n        }\n    }\n\n    hasStaticItems() {\n        const {staticItems, store, data} = this.props;\n        return !!(staticItems || (data && !store));\n    }\n\n    render() {\n        const props = propsWithout(['data', 'store', 'ref', 'key'], this.props);\n        /* jshint ignore:start */\n        return (\n            <ha-textfield-type-ahead\n                ref={this.handleRef}\n                class={this.props.className}\n                onClick={this.handleClick}\n                staticItems={this.hasStaticItems()}\n                {...props}\n            >\n                {this.props.children}\n            </ha-textfield-type-ahead>\n        );\n        /* jshint ignore:end */\n    }\n}\n"]}