{"version":3,"sources":["../../../react-components/HAPortal.jsx"],"names":[],"mappings":"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","file":"HAPortal.js","sourcesContent":["import React from 'react';\nimport ReactDOM, { findDOMNode } from 'react-dom';\nimport Position from \"hui/core/position\"\nconst shallowCompare = React.addons.shallowCompare;\nlet underlayZIndex = [];\n\nexport default class Portal extends React.Component {\n\n  static propTypes = {\n    children: React.PropTypes.element.isRequired\n  };\n\n  constructor() {\n    super();\n    this.potral = null;\n    this.container = null;\n  }\n\n  componentDidMount() {\n    this.potral = document.createElement('div');\n    document.body.appendChild(this.potral);\n    // use unstable_renderSubtreeIntoContainer to pass relay context\n    this.container = ReactDOM.unstable_renderSubtreeIntoContainer(this, this.props.children, this.potral);\n  }\n\n  componentWillUpdate(nextProps) {\n    if (nextProps.show) {\n      // use unstable_renderSubtreeIntoContainer to pass relay context\n      this.container = ReactDOM.unstable_renderSubtreeIntoContainer(this, nextProps.children, this.potral);\n\n      // if the container does not have a z-index we need to calculate one for it\n      // this can happen if it's a new container, or a container we hid that has not been unmounted yet\n      // if a drawer does not have a background, noUnderlay is true and we do not have to modify the underlay\n      if (!this.container.style.zIndex && !this.props.noUnderlay) {\n        // underlay must get moved first to it's z-index is less than the container's\n        this.moveUnderlay(Position.getTopZindex());\n      }\n      if (!this.container.style.zIndex) {\n        this.container.style.zIndex = Position.getTopZindex();\n      }\n    } else if (nextProps.show === false && this.container && this.container.style.zIndex) {\n      /* If show is false, and we have a container, and the container has a z-index.\n       * Then we need to move the underlay lower (or remove it), and remove the z-index from\n       * the container.  We remove the z-index so we can determine what it's new z-index is\n       * if we show it again before unmounting it.\n      */\n\n      // if a drawer does not have a background, noUnderlay is true and we do not have to modify the underlay\n      if (!this.props.noUnderlay) {\n        let underlay = document.body.querySelector(\".ha-underlay\");\n\n        // if there are multiple layers, pop the top one and move the underlay down a layer\n        // else there are no more layers left so we need to remove the underlay from the dom\n        if (underlayZIndex.pop() && underlayZIndex.length) {\n          underlay.style.zIndex = underlayZIndex[underlayZIndex.length - 1];\n        } else if (underlay) {\n          document.body.removeChild(underlay);\n        }\n        this.container.style.zIndex = null;\n      }\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return shallowCompare(this, nextProps, nextState);\n  }\n\n  componentWillUnmount() {\n    if (this.potral) {\n      ReactDOM.unmountComponentAtNode(this.potral);\n      document.body.removeChild(this.potral);\n    }\n    this.potral = null;\n    this.container = null;\n  }\n\n  moveUnderlay(zIndex) {\n    let underlay = document.body.querySelector(\".ha-underlay\");\n\n    // if there is no underlay div, create one and append to the body\n    if(!underlay) {\n      underlay = document.createElement('div');\n      underlay.classList.add('ha-underlay');\n      underlay.tabIndex = -1;\n      document.body.appendChild(underlay);\n    }\n    underlay.style.zIndex = zIndex;\n    underlayZIndex.push(zIndex);\n  }\n\n  render() {\n    return null;\n  }\n}"]}